@import 'tailwindcss';

@theme {
  /* ── Font ── */
  --font-sans: 'Inter', ui-sans-serif, system-ui, sans-serif;

  /* ── Site theme colors (dynamic via [data-theme] override) ── */
  --color-page: #fff;
  --color-panel: #f5f5f5;
  --color-tile: #fff;
  --color-heading: #1a1a1a;
  --color-body: #444;
  --color-subtle: #666;
  --color-dim: #999;
  --color-ghost: #bbb;
  --color-accent: #4a7c9b;
  --color-stroke: #e5e5e5;
  --color-stroke-soft: #eee;
  --color-curtain: rgba(0, 0, 0, 0.4);
  --color-banner-stroke: transparent;

  /* ── Glucose range colors (saturated — metrics, current reading) ── */
  --color-glucose-low: #ef4444;
  --color-glucose-normal: #22c55e;
  --color-glucose-high: #f59e0b;
  --color-glucose-very-high: #f97316;

  /* ── Glucose chart zone backgrounds (muted, Dexcom-inspired) ── */
  --color-glucose-zone-low: #d48a8a;
  --color-glucose-zone-normal: #8a9a6c;
  --color-glucose-zone-high: #c9b87a;

  /* ── Chart dot color (flips with theme) ── */
  --color-chart-dot: #1a1a1a;

  /* ── Insulin chart colors ── */
  --color-insulin-bolus: #6366f1;
  --color-insulin-basal: #a78bfa;

  /* ── Activity ring colors ── */
  --color-activity-move: #fa114f;
  --color-activity-exercise: #92e82a;
  --color-activity-stand: #00c7fc;

  /* ── Legacy dashboard tokens (used by /dashboard) ── */
  --color-surface: #0f172a;
  --color-surface-raised: #1e293b;
  --color-surface-overlay: #334155;
  --color-brand: #6366f1;
  --color-brand-light: #818cf8;
  --color-text-primary: #f8fafc;
  --color-text-secondary: #94a3b8;
  --color-text-muted: #64748b;
}

/* ── Dark theme overrides ── */
[data-theme="dark"] {
  --color-page: #0a0a0a;
  --color-panel: #111;
  --color-tile: #161616;
  --color-heading: #fff;
  --color-body: #d4d4d4;
  --color-subtle: #999;
  --color-dim: #666;
  --color-ghost: #555;
  --color-accent: #2dd4bf;
  --color-stroke: #222;
  --color-stroke-soft: #222;
  --color-curtain: rgba(0, 0, 0, 0.6);
  --color-banner-stroke: #222;
  --color-chart-dot: #e5e5e5;
}

/* ── Non-color theme variable ── */
:root { --topo-url: url('/topo-light.svg'); }
[data-theme="dark"] { --topo-url: url('/topo-dark.svg'); }

/* ── Base styles ── */
@layer base {
  a { color: var(--color-accent); }
  a:hover { text-decoration: underline; }
}

/* ── Sidebar: transform states (can't be pure utilities due to JS toggle) ── */
.sidebar {
  transform: translateX(-100%);
}
@media (min-width: 768px) {
  .sidebar {
    transform: translateX(0);
  }
}
body.sidebar-open .sidebar {
  transform: translateX(0);
}

/* ── Sidebar overlay: visibility toggle ── */
.sidebar-overlay {
  display: none;
}
body.sidebar-open .sidebar-overlay {
  display: block;
}

/* ── Sidebar: topo pattern pseudo-element ── */
.sidebar::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 100%;
  background: var(--topo-url) repeat;
  background-size: 300px 300px;
  background-position: bottom;
  mask-image: linear-gradient(to bottom, transparent 5%, rgba(0,0,0,0.5) 30%, black 55%);
  -webkit-mask-image: linear-gradient(to bottom, transparent 5%, rgba(0,0,0,0.5) 30%, black 55%);
  pointer-events: none;
  z-index: 0;
}

/* ── Sidebar content: faded background over topo ── */
.sidebar-content::after {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--color-panel);
  border-radius: 0 0 16px 16px;
  z-index: -1;
  mask-image: linear-gradient(to bottom, black 55%, transparent 90%);
  -webkit-mask-image: linear-gradient(to bottom, black 55%, transparent 90%);
}

/* ── Theme toggle: icon visibility ── */
.icon-sun { display: none; }
.icon-moon { display: block; }
[data-theme="dark"] .icon-sun { display: block; }
[data-theme="dark"] .icon-moon { display: none; }
